{
  "type": "workflow_collections",
  "data": [
    {
      "@context": "/api/3/contexts/WorkflowCollection",
      "@type": "WorkflowCollection",
      "name": "Sample - IBM QRadar - 1.6.2",
      "description": "Sample playbooks for \"IBM QRadar\" connector. If you are planning to use any of the sample playbooks in your environment, ensure that you clone those playbooks and move them to a different collection, since the sample playbook collection gets deleted during connector upgrade and delete.",
      "visible": true,
      "image": "/api/3/images/85fe3409-e896-4e8e-9663-5cf02e8e15bd",
      "id": 276,
      "createDate": 1676990202.918178,
      "modifyDate": 1676990202.918178,
      "deletedAt": null,
      "importedBy": [],
      "recordTags": [
        "qradar"
      ],
      "workflows": [
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Events Related to an Offense",
          "aliasName": null,
          "tag": "#IBM QRadar",
          "description": "Retrieves details of events associated with a QRadar offense, from the QRadar server, based on the QRadar offense ID that you have specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": null,
          "collection": "/api/3/workflow_collections/9a38c491-3e1d-4840-af6e-1407a79e15ad",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/b19ad1a6-6e58-4b54-b65a-21329bdcaf8c",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get Events Related to an Offense",
              "description": null,
              "arguments": {
                "name": "IBM QRadar",
                "config": "''",
                "params": {
                  "offense_id": "",
                  "start_time": "",
                  "max_results": 100,
                  "last_updated_time": ""
                },
                "version": "1.6.2",
                "connector": "qradar",
                "operation": "get_events_related_to_offense",
                "operationTitle": "Get Events Related to an Offense",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "6eb5ccca-338e-44e3-b0db-6b3ec693d139"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "241ca2d2-8087-438b-8578-4d2e67af9701",
                "title": "IBM QRadar: Get Events Related to an Offense",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "b19ad1a6-6e58-4b54-b65a-21329bdcaf8c"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start-> Get Events Related to an Offense",
              "targetStep": "/api/3/workflow_steps/6eb5ccca-338e-44e3-b0db-6b3ec693d139",
              "sourceStep": "/api/3/workflow_steps/b19ad1a6-6e58-4b54-b65a-21329bdcaf8c",
              "label": null,
              "isExecuted": false,
              "uuid": "9b2d49b1-ba86-4ec7-b38f-394e43cc15ff"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "0ca36969-5478-44ba-858a-0a1eb71d6928",
          "id": 4074,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "qradar"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Offense Closing Reasons",
          "aliasName": null,
          "tag": "#IBM QRadar",
          "description": "Retrieves a list of closing reasons associated with all offenses from the QRadar server.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": null,
          "collection": "/api/3/workflow_collections/9a38c491-3e1d-4840-af6e-1407a79e15ad",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/b8f856d1-a2fc-4bda-9361-76b78f71485f",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "03e1edd8-4e46-43b6-954c-f7e2b4c8d91f",
                "title": "IBM QRadar: Get Offense Closing Reasons",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "b8f856d1-a2fc-4bda-9361-76b78f71485f"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Offense Closing Reasons",
              "description": null,
              "arguments": {
                "name": "IBM QRadar",
                "config": "''",
                "params": [],
                "version": "1.6.2",
                "connector": "qradar",
                "operation": "get_closing_reasons",
                "operationTitle": "Get Offense Closing Reasons",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "e252f0f6-397e-45fe-8125-b9e68634a298"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start-> Get Offense Closing Reasons",
              "targetStep": "/api/3/workflow_steps/e252f0f6-397e-45fe-8125-b9e68634a298",
              "sourceStep": "/api/3/workflow_steps/b8f856d1-a2fc-4bda-9361-76b78f71485f",
              "label": null,
              "isExecuted": false,
              "uuid": "0f7c3999-a6ee-465b-9e23-59ab1cf12140"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "14b71a0c-b450-4447-9fab-1fe879369650",
          "id": 4069,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "qradar"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Cases",
          "aliasName": null,
          "tag": "#IBM QRadar",
          "description": "Retrieves a detailed list of cases from Qradar based on input parameters specified",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": null,
          "collection": "/api/3/workflow_collections/9a38c491-3e1d-4840-af6e-1407a79e15ad",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/e4b639dd-b1a6-4842-876c-28499cdd2a8e",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get Cases",
              "description": null,
              "arguments": {
                "name": "IBM QRadar",
                "config": "''",
                "params": {
                  "max_results": 100,
                  "query.fields": "",
                  "filter_string": ""
                },
                "version": "1.6.2",
                "connector": "qradar",
                "operation": "get_cases",
                "operationTitle": "Get Cases",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "87f7c731-b2e0-43f9-a71e-bc78024d82ff"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "3b37f0fb-8f63-40ff-a774-646a28ede831",
                "title": "IBM QRadar: Get Cases",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "e4b639dd-b1a6-4842-876c-28499cdd2a8e"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start-> Get Cases",
              "targetStep": "/api/3/workflow_steps/87f7c731-b2e0-43f9-a71e-bc78024d82ff",
              "sourceStep": "/api/3/workflow_steps/e4b639dd-b1a6-4842-876c-28499cdd2a8e",
              "label": null,
              "isExecuted": false,
              "uuid": "c62238bc-7134-4104-953a-c4d9869722b4"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "179ae2d3-0ddf-4949-8efe-aa3154ec8ac6",
          "id": 4082,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "qradar"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Source IP Addresses",
          "aliasName": null,
          "tag": "#IBM QRadar",
          "description": "Retrieves IP address details associated with a source address IDs from the QRadar server, based on the source address IDs that you have specified",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": null,
          "collection": "/api/3/workflow_collections/9a38c491-3e1d-4840-af6e-1407a79e15ad",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/d280ec68-3759-432a-aad6-d3b2f73f446d",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get Source IP Addresses",
              "description": null,
              "arguments": {
                "name": "IBM QRadar",
                "config": "''",
                "params": [],
                "version": "1.6.2",
                "connector": "qradar",
                "operation": "get_source_ip",
                "operationTitle": "Get Source IP Addresses",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "394c81cd-9f36-4b4b-a916-39bcc7bcd9bb"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "d3b648b1-b215-4eb7-813f-27e32a30c350",
                "title": "IBM QRadar: Get Source IP Addresses",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "d280ec68-3759-432a-aad6-d3b2f73f446d"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start-> Get Source IP Addresses",
              "targetStep": "/api/3/workflow_steps/394c81cd-9f36-4b4b-a916-39bcc7bcd9bb",
              "sourceStep": "/api/3/workflow_steps/d280ec68-3759-432a-aad6-d3b2f73f446d",
              "label": null,
              "isExecuted": false,
              "uuid": "c8c88b25-caf3-415e-8de9-2bcda24090c1"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "1af0ccf0-c391-43d2-907d-d58eb8a65ca6",
          "id": 4075,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "qradar"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Add or Update Table Element",
          "aliasName": null,
          "tag": "#IBM QRadar",
          "description": "Specify the element to add or update in the reference table on Qradar based on the input parameters specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": null,
          "collection": "/api/3/workflow_collections/9a38c491-3e1d-4840-af6e-1407a79e15ad",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/6b229fc2-e14c-47b8-a6df-40f756aba313",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Add or Update Table Element",
              "description": null,
              "arguments": {
                "name": "IBM QRadar",
                "config": "''",
                "params": {
                  "path.name": "",
                  "query.value": "",
                  "query.fields": "",
                  "query.source": "FortiSOAR",
                  "query.domain_id": "",
                  "query.inner_key": "",
                  "query.namespace": "",
                  "query.outer_key": ""
                },
                "version": "1.6.2",
                "connector": "qradar",
                "operation": "add_table_element",
                "operationTitle": "Add or Update Table Element",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "21eb603f-462c-4a47-bbef-c579e4db27e3"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "66fa6703-3143-48bc-bd7e-2d96d7953404",
                "title": "IBM QRadar: Add or Update Table Element",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "6b229fc2-e14c-47b8-a6df-40f756aba313"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start-> Add or Update Table Element",
              "targetStep": "/api/3/workflow_steps/21eb603f-462c-4a47-bbef-c579e4db27e3",
              "sourceStep": "/api/3/workflow_steps/6b229fc2-e14c-47b8-a6df-40f756aba313",
              "label": null,
              "isExecuted": false,
              "uuid": "8548de23-4968-4df5-b589-6732c0a09217"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "1c523586-2b73-4901-bc1b-efbce021ac21",
          "id": 4087,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "qradar"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Reference Tables",
          "aliasName": null,
          "tag": "#IBM QRadar",
          "description": "Retrieves a detailed list of reference tables from Qradar",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": null,
          "collection": "/api/3/workflow_collections/9a38c491-3e1d-4840-af6e-1407a79e15ad",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/8deb5084-0a5a-44a0-a3ee-8e3394585f96",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "708c8b1e-6279-4fd9-bb41-a289546c2ae7",
                "title": "IBM QRadar: Get Reference Tables",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "8deb5084-0a5a-44a0-a3ee-8e3394585f96"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Reference Tables",
              "description": null,
              "arguments": {
                "name": "IBM QRadar",
                "config": "''",
                "params": {
                  "max_results": 100,
                  "query.fields": "",
                  "filter_string": ""
                },
                "version": "1.6.2",
                "connector": "qradar",
                "operation": "get_reference_tables",
                "operationTitle": "Get Reference Tables",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "aa2f1b4e-ad4e-41ab-bf27-3e47439f7d86"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start-> Get Reference Tables",
              "targetStep": "/api/3/workflow_steps/aa2f1b4e-ad4e-41ab-bf27-3e47439f7d86",
              "sourceStep": "/api/3/workflow_steps/8deb5084-0a5a-44a0-a3ee-8e3394585f96",
              "label": null,
              "isExecuted": false,
              "uuid": "c2e39dcf-4d35-4436-a120-7dc8b3629ff3"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "2aebb790-ba89-4a7b-be94-df4f398bddb9",
          "id": 4084,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "qradar"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "IBM QRadar > Post Create Alert > Fetch Events",
          "aliasName": null,
          "tag": "#qradar #dataingestion",
          "description": "Fetch events, source and destination ip address of an offense.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [
            "qradar_timezone",
            "qradar_event_limit",
            "alertRecord"
          ],
          "synchronous": false,
          "lastModifyDate": 1676990399,
          "collection": "/api/3/workflow_collections/9a38c491-3e1d-4840-af6e-1407a79e15ad",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/bd58c9c5-3e44-4760-a8a1-823162b6cb60",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Set Source Data",
              "description": null,
              "arguments": {
                "alertSourceData": "{{vars.input.params.alertRecord.sourcedata | from_json}}"
              },
              "status": null,
              "top": "111",
              "left": "189",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "01ac69ff-59a2-4696-a249-a1986f582536"
            },
            {
              "@type": "WorkflowStep",
              "name": "Update Alert",
              "description": null,
              "arguments": {
                "resource": {
                  "sourcedata": "{{vars.offense_details | toJSON }}"
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "{{vars.input.params.alertRecord['@id']}}",
                "__recommend": [],
                "collectionType": "/api/3/alerts",
                "fieldOperation": {
                  "recordTags": "Append"
                },
                "step_variables": []
              },
              "status": null,
              "top": "353",
              "left": "840",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928722",
              "group": null,
              "uuid": "0a5d9a2b-f044-4d65-9f28-4e21fb136aba"
            },
            {
              "@type": "WorkflowStep",
              "name": "Fetch Events For an Offense",
              "description": null,
              "arguments": {
                "name": "IBM QRadar",
                "config": "",
                "params": {
                  "search_string": "SELECT  {{vars.event_query_params}} FROM EVENTS WHERE INOFFENSE({{vars.alertSourceData.offense_data['id']}}) ORDER BY starttime DESC LIMIT {{vars.event_record_limit}} START  '{{vars.offense_start_time}}' STOP '{{vars.current_time}}'"
                },
                "version": "1.6.2",
                "connector": "qradar",
                "operation": "query_qradar",
                "operationTitle": "Make an Ariel Query to QRadar",
                "step_variables": {
                  "offense_details": "{\n\"offense_data\": {{vars.alertSourceData.offense_data}},\n\"events_data\": {{vars.result.data.events}}\n}"
                }
              },
              "status": null,
              "top": "271",
              "left": "649",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "86b78a10-8246-43d9-8cce-58ef6f35ecca"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": []
                  }
                }
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "group": null,
              "uuid": "bd58c9c5-3e44-4760-a8a1-823162b6cb60"
            },
            {
              "@type": "WorkflowStep",
              "name": "Configuration",
              "description": null,
              "arguments": {
                "current_time": "{{arrow.now(vars.input.params['qradar_timezone']).format('YYYY-MM-DD HH:mm:ss')}}",
                "event_query_params": "starttime,sourceip,destinationip,username,QIDNAME(qid) as 'Event_Name',CATEGORYNAME(category) AS 'Category_Name',LOGSOURCENAME(logsourceid) as 'Log_Source'",
                "event_record_limit": "{% if vars.input.params['qradar_event_limit']%}{{vars.input.params['qradar_event_limit']}}{% else %}50{% endif %}",
                "offense_start_time": "{{arrow.get((vars.alertSourceData.offense_data.start_time | int )/1000).to(vars.input.params['qradar_timezone']).format('YYYY-MM-DD HH:mm:ss')}}"
              },
              "status": null,
              "top": "200",
              "left": "340",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "d9e3f2fd-cccd-41d1-ae45-5fbb5d1e3445"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Set Source Data",
              "targetStep": "/api/3/workflow_steps/01ac69ff-59a2-4696-a249-a1986f582536",
              "sourceStep": "/api/3/workflow_steps/bd58c9c5-3e44-4760-a8a1-823162b6cb60",
              "label": null,
              "isExecuted": false,
              "uuid": "687035b4-edb9-4696-9b7f-86cc2e36644d"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Source Data -> Configuration",
              "targetStep": "/api/3/workflow_steps/d9e3f2fd-cccd-41d1-ae45-5fbb5d1e3445",
              "sourceStep": "/api/3/workflow_steps/01ac69ff-59a2-4696-a249-a1986f582536",
              "label": null,
              "isExecuted": false,
              "uuid": "7e20706e-c8a7-44ea-a2cd-9955d4c6d8d5"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Fetch Events For an Offense -> Update Alert",
              "targetStep": "/api/3/workflow_steps/0a5d9a2b-f044-4d65-9f28-4e21fb136aba",
              "sourceStep": "/api/3/workflow_steps/86b78a10-8246-43d9-8cce-58ef6f35ecca",
              "label": null,
              "isExecuted": false,
              "uuid": "d7576874-e782-463a-9c9a-2540adc0462c"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Fetch Events For an Offense",
              "targetStep": "/api/3/workflow_steps/86b78a10-8246-43d9-8cce-58ef6f35ecca",
              "sourceStep": "/api/3/workflow_steps/d9e3f2fd-cccd-41d1-ae45-5fbb5d1e3445",
              "label": null,
              "isExecuted": false,
              "uuid": "e2315370-2548-422e-b589-43a56c2b093d"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "3464515e-56cf-4fd2-afa1-985b02064a88",
          "id": 4094,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "dataingestion",
            "qradar"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "IBM QRadar > Ingest",
          "aliasName": null,
          "tag": "#qradar #ingest #dataingestion",
          "description": "This playbook demonstrates Get Offense Operation.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1676990399,
          "collection": "/api/3/workflow_collections/9a38c491-3e1d-4840-af6e-1407a79e15ad",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/58077823-18f4-443d-8572-d65cefac5b16",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Create Alert",
              "description": null,
              "arguments": {
                "when": "{{( vars.steps.Fetch_Offenses.data!= None) and ( vars.steps.Fetch_Offenses.data| length > 0)}}",
                "for_each": {
                  "item": "{{ vars.steps.Fetch_Offenses.data}}",
                  "parallel": false,
                  "condition": ""
                },
                "arguments": {
                  "sourcedata": "{{vars.item}}",
                  "qradar_pull_time": "{{vars.qradar_pull_time}}"
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/5204679f-b509-4d54-8fde-1aa35030c7df"
              },
              "status": null,
              "top": "360",
              "left": "700",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "group": null,
              "uuid": "30505af9-ece5-4d83-b610-ae2119e619af"
            },
            {
              "@type": "WorkflowStep",
              "name": "Update Last Offense Pull Time",
              "description": null,
              "arguments": {
                "name": "Utilities",
                "params": {
                  "macro": "{{vars.qradar_pull_time}}",
                  "value": "{{ vars.steps.Fetch_Offenses.curr_timestamp}}"
                },
                "version": "3.2.1",
                "connector": "cyops_utilities",
                "operation": "updatemacro",
                "operationTitle": "CyOPs: Update Macro",
                "step_variables": []
              },
              "status": null,
              "top": "440",
              "left": "1020",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "40a0d1ae-1284-4108-b008-a0dedd2824b9"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "87506909-3e14-4c00-aa4c-1a1c5af24131",
                "title": "QRadar > Fetch Offenses Now",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records}}"
                  }
                },
                "displayConditions": {
                  "alerts": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  },
                  "incidents": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "40",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "58077823-18f4-443d-8572-d65cefac5b16"
            },
            {
              "@type": "WorkflowStep",
              "name": "Fetch Offenses",
              "description": null,
              "arguments": {
                "arguments": [],
                "step_variables": [],
                "workflowReference": "/api/3/workflows/8f7eb129-98d4-43e8-a10b-8970e39065e9"
              },
              "status": null,
              "top": "140",
              "left": "240",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "group": null,
              "uuid": "5f0e0127-a444-4b2d-8fec-c66d9845508c"
            },
            {
              "@type": "WorkflowStep",
              "name": "Configuration",
              "description": null,
              "arguments": {
                "qradar_timezone": "{{vars.steps.Fetch_Offenses.QRadarTimeZoneMacro}}",
                "qradar_pull_time": "{{vars.steps.Fetch_Offenses.QRadarPullTimeMacro}}",
                "qradar_event_limit": "{{vars.steps.Fetch_Offenses.QRadarLimitMacro}}"
              },
              "status": null,
              "top": "260",
              "left": "400",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "8b0a476b-4941-40ff-b689-294fcf432d58"
            },
            {
              "@type": "WorkflowStep",
              "name": "Fetch Related Events of Offense",
              "description": null,
              "arguments": {
                "when": "{{vars.steps.Create_Alert}}",
                "for_each": {
                  "item": "{{vars.steps.Create_Alert}}",
                  "parallel": false,
                  "condition": ""
                },
                "arguments": {
                  "alertRecord": "{{vars.item}}",
                  "qradar_timezone": "{{vars.qradar_timezone}}",
                  "qradar_event_limit": "{{vars.qradar_event_limit}}"
                },
                "apply_async": true,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/3464515e-56cf-4fd2-afa1-985b02064a88"
              },
              "status": null,
              "top": "520",
              "left": "1340",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "group": null,
              "uuid": "a0d61337-8a53-424b-911e-ab34f062f107"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Create Alert -> Update Last Offense Pull Time",
              "targetStep": "/api/3/workflow_steps/40a0d1ae-1284-4108-b008-a0dedd2824b9",
              "sourceStep": "/api/3/workflow_steps/30505af9-ece5-4d83-b610-ae2119e619af",
              "label": null,
              "isExecuted": false,
              "uuid": "00c43973-04bf-4d40-a1f4-ab6308a4b827"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Update Last Offense Pull Time -> Fetch Related Events of Offense",
              "targetStep": "/api/3/workflow_steps/a0d61337-8a53-424b-911e-ab34f062f107",
              "sourceStep": "/api/3/workflow_steps/40a0d1ae-1284-4108-b008-a0dedd2824b9",
              "label": null,
              "isExecuted": false,
              "uuid": "1da9b1fb-5d04-43cd-a86f-a6c27b1df5b1"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Fetch Offenses",
              "targetStep": "/api/3/workflow_steps/5f0e0127-a444-4b2d-8fec-c66d9845508c",
              "sourceStep": "/api/3/workflow_steps/58077823-18f4-443d-8572-d65cefac5b16",
              "label": null,
              "isExecuted": false,
              "uuid": "253b9450-0f2e-4b47-b6f2-8d6c66a22518"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Fetch Offenses -> Configuration",
              "targetStep": "/api/3/workflow_steps/8b0a476b-4941-40ff-b689-294fcf432d58",
              "sourceStep": "/api/3/workflow_steps/5f0e0127-a444-4b2d-8fec-c66d9845508c",
              "label": null,
              "isExecuted": false,
              "uuid": "428fc692-624f-4c24-8083-4c36aeb67145"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Create Alert",
              "targetStep": "/api/3/workflow_steps/30505af9-ece5-4d83-b610-ae2119e619af",
              "sourceStep": "/api/3/workflow_steps/8b0a476b-4941-40ff-b689-294fcf432d58",
              "label": null,
              "isExecuted": false,
              "uuid": "731966c9-a634-42df-8a09-62d338d6e210"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "3567cd0f-6c2d-4319-97ad-bd9d2d63bd12",
          "id": 4093,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "dataingestion",
            "ingest",
            "qradar"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Offense Notes",
          "aliasName": null,
          "tag": "#IBM QRadar",
          "description": "Retrieves a list of notes associated with a specified offense in QRadar based on the offense ID you have specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": null,
          "collection": "/api/3/workflow_collections/9a38c491-3e1d-4840-af6e-1407a79e15ad",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/d63a7afa-b379-48df-b0a4-281ad11d6ecf",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get Offense Notes",
              "description": null,
              "arguments": {
                "name": "IBM QRadar",
                "config": "''",
                "params": {
                  "offense_id": null
                },
                "version": "1.6.2",
                "connector": "qradar",
                "operation": "get_notes",
                "operationTitle": "Get Offense Notes",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "8447f134-6710-422c-b9f0-2ed7e90fec39"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "77e68482-647b-46e3-805c-41629d61c223",
                "title": "IBM QRadar: Get Offense Notes",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "d63a7afa-b379-48df-b0a4-281ad11d6ecf"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start-> Get Offense Notes",
              "targetStep": "/api/3/workflow_steps/8447f134-6710-422c-b9f0-2ed7e90fec39",
              "sourceStep": "/api/3/workflow_steps/d63a7afa-b379-48df-b0a4-281ad11d6ecf",
              "label": null,
              "isExecuted": false,
              "uuid": "6e9e549d-c0b7-43c9-8782-2fa9284390f0"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "365d9550-e85c-4daa-aa15-c09142366c55",
          "id": 4071,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "qradar"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Close Offense",
          "aliasName": null,
          "tag": "#IBM QRadar",
          "description": "Closes an offense on the QRadar server based on the offense ID that you have specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": null,
          "collection": "/api/3/workflow_collections/9a38c491-3e1d-4840-af6e-1407a79e15ad",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/fba75498-a1f3-496d-a7d9-1d10d02e01bd",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Close Offense",
              "description": null,
              "arguments": {
                "name": "IBM QRadar",
                "config": "''",
                "params": {
                  "offense_id": null,
                  "closure_note": null,
                  "offense_close_id": null
                },
                "version": "1.6.2",
                "connector": "qradar",
                "operation": "close_offense",
                "operationTitle": "Close Offense",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "9a04f729-dad7-4754-b612-1dff8a6e71f2"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "e7e4a469-5de5-489d-a708-15a9d5162085",
                "title": "IBM QRadar: Close Offense",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "fba75498-a1f3-496d-a7d9-1d10d02e01bd"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start-> Close Offense",
              "targetStep": "/api/3/workflow_steps/9a04f729-dad7-4754-b612-1dff8a6e71f2",
              "sourceStep": "/api/3/workflow_steps/fba75498-a1f3-496d-a7d9-1d10d02e01bd",
              "label": null,
              "isExecuted": false,
              "uuid": "c6b89d70-db96-483a-a712-22380c9aac60"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "4328bd09-4468-4e78-a243-89f7046093f5",
          "id": 4072,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "qradar"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Create Note",
          "aliasName": null,
          "tag": "#IBM QRadar",
          "description": "Creates a note for a specified offense in QRadar based on the offense ID you have specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": null,
          "collection": "/api/3/workflow_collections/9a38c491-3e1d-4840-af6e-1407a79e15ad",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/abaa8ae9-64fe-42ec-be47-b3ae8060919a",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Create Note",
              "description": null,
              "arguments": {
                "name": "IBM QRadar",
                "config": "''",
                "params": {
                  "offense_id": null,
                  "closure_note": null
                },
                "version": "1.6.2",
                "connector": "qradar",
                "operation": "add_notes",
                "operationTitle": "Create Note",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "574df82d-f135-4b9a-9ec1-c6d92a899642"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "d6e6293f-e776-40fa-9bf3-51b4da4afb55",
                "title": "IBM QRadar: Create Note",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "abaa8ae9-64fe-42ec-be47-b3ae8060919a"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start-> Create Note",
              "targetStep": "/api/3/workflow_steps/574df82d-f135-4b9a-9ec1-c6d92a899642",
              "sourceStep": "/api/3/workflow_steps/abaa8ae9-64fe-42ec-be47-b3ae8060919a",
              "label": null,
              "isExecuted": false,
              "uuid": "7ba8cd28-11b1-438c-b3f8-8b1a6a578d01"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "4f38cbf2-482e-477f-98a7-9a7c65180653",
          "id": 4073,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "qradar"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "> IBM QRadar > Create Alert",
          "aliasName": null,
          "tag": "#qradar #dataingestion #create",
          "description": "This playbook creates the offense as an alert in CyOPs.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [
            "sourcedata",
            "qradar_pull_time"
          ],
          "synchronous": false,
          "lastModifyDate": 1676990399,
          "collection": "/api/3/workflow_collections/9a38c491-3e1d-4840-af6e-1407a79e15ad",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/cd2b3031-5844-43bc-9152-07a502551c98",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Add a note of offense update",
              "description": null,
              "arguments": {
                "when": "{{vars.sourcedata.start_time > ((vars.input.params['qradar_pull_time']| int)*1000) or vars.sourcedata.last_updated_time > ((vars.input.params['qradar_pull_time']| int)*1000)}}",
                "resource": {
                  "type": "/api/3/picklists/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                  "people": [],
                  "content": "<p>Below is the latest summary:</p>\n<p>status: {{vars.sourcedata.status}}<br />inactive: {{vars.sourcedata.inactive}}<br />severity: {{vars.sourcedata.severity}}<br />magnitude: {{vars.sourcedata.magnitude}}<br />relevance: {{vars.sourcedata.relevance}}<br />categories: {{vars.sourcedata.categories}}<br />assigned_to: {{vars.sourcedata.assigned_to}}<br />event_count: {{vars.sourcedata.event_count}}<br />closing_user: {{vars.sourcedata.closing_user}}<br />offense_type: {{vars.sourcedata.offense_type}}</p>",
                  "__replace": "",
                  "isImportant": false,
                  "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "/api/3/comments",
                "__recommend": [],
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "top": "200",
              "left": "380",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "group": null,
              "uuid": "990dfc1b-980b-4bc6-9dcd-6072e938b7c1"
            },
            {
              "@type": "WorkflowStep",
              "name": "Create Record",
              "description": null,
              "arguments": {
                "resource": {
                  "name": "{{vars.sourcedata['description']}}",
                  "type": "/api/3/picklists/574a6ee2-7265-4701-815e-cff83b053bce",
                  "state": "/api/3/picklists/a1bac09b-1441-45aa-ad1b-c88744e48e72",
                  "source": "QRadar",
                  "status": "{{ vars.sourcedata[\"status\"]  | resolveRange(vars.alerts_status_map)}}",
                  "comments": "[\"{{vars.steps.Add_a_note_of_offense_update['@id']}}\"]",
                  "severity": "{{ vars.sourcedata[\"severity\"]  | resolveRange(vars.alerts_severity_map)}}",
                  "sourceId": "{{vars.sourcedata['id']}}",
                  "__replace": "true",
                  "sourcedata": "{{vars.offense_data | toJSON }}",
                  "description": "<p>{% if vars.sourcedata.source_address_details | length !=0 %}</p>\n<p>{{ vars.sourcedata.source_address_details | json2html }}</p>\n<p>{% endif %}{% if vars.sourcedata.destination_address_details | length != 0 %}</p>\n<p>{{ vars.sourcedata.destination_address_details | json2html }}</p>\n<p>{% endif %}</p>",
                  "ackSlaStatus": "/api/3/picklists/72979f64-e8b9-4888-a965-957e0ec24818",
                  "respSlaStatus": "/api/3/picklists/72979f64-e8b9-4888-a965-957e0ec24818",
                  "priorityWeight": 1,
                  "escalatedtoincident": "/api/3/picklists/2128a09c-153d-4db3-985d-de6be33deae5",
                  "alertRemainingAckSLA": 0
                },
                "_showJson": false,
                "is_upsert": true,
                "operation": "Overwrite",
                "collection": "/api/3/upsert/alerts",
                "__recommend": [],
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "top": "320",
              "left": "560",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "group": null,
              "uuid": "c56a521e-e607-4832-b766-6677c94b41a1"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": {
                      "sourcedata": "{{ vars.sourcedata }}",
                      "qradar_pull_time": "{{ vars.qradar_pull_time }}"
                    }
                  }
                }
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "group": null,
              "uuid": "cd2b3031-5844-43bc-9152-07a502551c98"
            },
            {
              "@type": "WorkflowStep",
              "name": "Configuration",
              "description": null,
              "arguments": {
                "offense_data": "{ 'offense_data':  {{vars.input.params.sourcedata}},\n'events_data': []\n}",
                "alerts_status_map": "{'OPEN': {{'AlertStatus'| picklist('Open') }}, 'CLOSED': {{'AlertStatus'| picklist('Closed') }}}",
                "alerts_severity_map": "{'1,2': {{'Severity'| picklist('Minimal') }}, '3,4': {{'Severity'| picklist('Low') }}, '5,6': {{'Severity'| picklist('Medium') }}, '7,8': {{'Severity'| picklist('High') }}, '9,10': {{'Severity'| picklist('Critical') }}}"
              },
              "status": null,
              "top": "100",
              "left": "220",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "fc9992c3-bfff-4b84-8143-9ac6a6f0d911"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Add a note of offense update",
              "targetStep": "/api/3/workflow_steps/990dfc1b-980b-4bc6-9dcd-6072e938b7c1",
              "sourceStep": "/api/3/workflow_steps/fc9992c3-bfff-4b84-8143-9ac6a6f0d911",
              "label": null,
              "isExecuted": false,
              "uuid": "29911627-3977-427a-8abd-80988bcbdb24"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Add a note of offense update -> Create Record",
              "targetStep": "/api/3/workflow_steps/c56a521e-e607-4832-b766-6677c94b41a1",
              "sourceStep": "/api/3/workflow_steps/990dfc1b-980b-4bc6-9dcd-6072e938b7c1",
              "label": null,
              "isExecuted": false,
              "uuid": "c99c15d9-61fb-4e4d-b57b-bf4ec507b669"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Configuration",
              "targetStep": "/api/3/workflow_steps/fc9992c3-bfff-4b84-8143-9ac6a6f0d911",
              "sourceStep": "/api/3/workflow_steps/cd2b3031-5844-43bc-9152-07a502551c98",
              "label": null,
              "isExecuted": false,
              "uuid": "e09081b8-4a45-4074-b2a5-6435c1f753a0"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "5204679f-b509-4d54-8fde-1aa35030c7df",
          "id": 4092,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "dataingestion",
            "create",
            "qradar"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Table Elements",
          "aliasName": null,
          "tag": "#IBM QRadar",
          "description": "Retrieves the record details of a reference table defined by name from Qradar",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": null,
          "collection": "/api/3/workflow_collections/9a38c491-3e1d-4840-af6e-1407a79e15ad",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/65658b2d-c1be-4c2e-8d41-80b15795ba91",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get Table Elements",
              "description": null,
              "arguments": {
                "name": "IBM QRadar",
                "config": "''",
                "params": {
                  "path.name": "",
                  "max_results": 100,
                  "query.fields": "",
                  "query.namespace": ""
                },
                "version": "1.6.2",
                "connector": "qradar",
                "operation": "get_table_elements",
                "operationTitle": "Get Table Elements",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "0451ed2d-5e05-406b-99b4-842055f1044a"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "4ad5a7d8-42a0-4da5-800e-f532a3a9e36f",
                "title": "IBM QRadar: Get Table Elements",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "65658b2d-c1be-4c2e-8d41-80b15795ba91"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start-> Get Table Elements",
              "targetStep": "/api/3/workflow_steps/0451ed2d-5e05-406b-99b4-842055f1044a",
              "sourceStep": "/api/3/workflow_steps/65658b2d-c1be-4c2e-8d41-80b15795ba91",
              "label": null,
              "isExecuted": false,
              "uuid": "4f4673ed-e423-41e8-86c8-24d3a55b44af"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "55f4272c-fb4d-443c-acec-7171ed950cfd",
          "id": 4086,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "qradar"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Create Case",
          "aliasName": null,
          "tag": "#IBM QRadar",
          "description": "Create a new case on Qradar",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": null,
          "collection": "/api/3/workflow_collections/9a38c491-3e1d-4840-af6e-1407a79e15ad",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/a60b6bbf-427a-4581-81c2-a31cf4359a6e",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "a1ed61ea-b0e6-4b7f-a344-a92a6bab7e89",
                "title": "IBM QRadar: Create Case",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "a60b6bbf-427a-4581-81c2-a31cf4359a6e"
            },
            {
              "@type": "WorkflowStep",
              "name": "Create Case",
              "description": null,
              "arguments": {
                "name": "IBM QRadar",
                "config": "''",
                "params": {
                  "body.case": {
                    "name": "case1",
                    "assigned_to": [
                      "admin"
                    ]
                  },
                  "content_type": "application/json"
                },
                "version": "1.6.2",
                "connector": "qradar",
                "operation": "create_case",
                "operationTitle": "Create Case",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "c0b6a34e-069f-49e0-850f-16f972f996b2"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start-> Create Case",
              "targetStep": "/api/3/workflow_steps/c0b6a34e-069f-49e0-850f-16f972f996b2",
              "sourceStep": "/api/3/workflow_steps/a60b6bbf-427a-4581-81c2-a31cf4359a6e",
              "label": null,
              "isExecuted": false,
              "uuid": "b21f367c-3571-470b-b8d3-2efb2159b46f"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "564a3dd4-5c03-448c-807c-d4fa4df25952",
          "id": 4083,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "qradar"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Invoke QRadar REST API",
          "aliasName": null,
          "tag": "#IBM QRadar",
          "description": "Invokes a function to Get or Post an API endpoint on the QRadar server.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": null,
          "collection": "/api/3/workflow_collections/9a38c491-3e1d-4840-af6e-1407a79e15ad",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/04ed772d-9c25-4b59-8af8-cfc1224a8565",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "cb9b80b3-f87e-4cd4-892a-79cce5d4d2fb",
                "title": "IBM QRadar: Invoke QRadar REST API",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "04ed772d-9c25-4b59-8af8-cfc1224a8565"
            },
            {
              "@type": "WorkflowStep",
              "name": "Invoke QRadar REST API",
              "description": null,
              "arguments": {
                "name": "IBM QRadar",
                "config": "''",
                "params": {
                  "method": "GET"
                },
                "version": "1.6.2",
                "connector": "qradar",
                "operation": "invoke_api",
                "operationTitle": "Invoke QRadar REST API",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "813ee6f9-7195-46ec-8a2f-0966e7b75c0f"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start-> Invoke QRadar REST API",
              "targetStep": "/api/3/workflow_steps/813ee6f9-7195-46ec-8a2f-0966e7b75c0f",
              "sourceStep": "/api/3/workflow_steps/04ed772d-9c25-4b59-8af8-cfc1224a8565",
              "label": null,
              "isExecuted": false,
              "uuid": "5b963fb8-e57b-432c-95fa-80f34a3bd6e2"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "6ccaca55-f08f-4f7f-9f82-a80bb1df81fa",
          "id": 4077,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "qradar"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Update Asset",
          "aliasName": null,
          "tag": "#IBM QRadar",
          "description": "Updates the attributes of a specific asset on the Qradar server based on the asset ID that you have specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": null,
          "collection": "/api/3/workflow_collections/9a38c491-3e1d-4840-af6e-1407a79e15ad",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/14644e3a-19ea-4f65-b367-ae02d8ad98c5",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "6f6a2904-5058-4850-9dbe-7e2c23b1265f",
                "title": "IBM QRadar: Update Asset",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "14644e3a-19ea-4f65-b367-ae02d8ad98c5"
            },
            {
              "@type": "WorkflowStep",
              "name": "Update Asset",
              "description": null,
              "arguments": {
                "name": "IBM QRadar",
                "config": "''",
                "params": {
                  "body.asset": {
                    "properties": [
                      {
                        "value": "testing",
                        "type_id": 1011
                      }
                    ]
                  },
                  "content_type": "text/plain",
                  "path.asset_id": ""
                },
                "version": "1.6.2",
                "connector": "qradar",
                "operation": "update_asset",
                "operationTitle": "Update Asset",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "eb846d29-676d-423f-933e-68c99cbc6e9d"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start-> Update Asset",
              "targetStep": "/api/3/workflow_steps/eb846d29-676d-423f-933e-68c99cbc6e9d",
              "sourceStep": "/api/3/workflow_steps/14644e3a-19ea-4f65-b367-ae02d8ad98c5",
              "label": null,
              "isExecuted": false,
              "uuid": "0ee43afe-4c9a-43f0-9fcb-d858df713417"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "6d1a6d2a-9b94-44a3-96f4-ec43d2aa923a",
          "id": 4081,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "qradar"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Offenses from QRadar",
          "aliasName": null,
          "tag": "#IBM QRadar",
          "description": "Retrieves a list of offenses from the QRadar server based on the filter string that you have specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": null,
          "collection": "/api/3/workflow_collections/9a38c491-3e1d-4840-af6e-1407a79e15ad",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/cfd45eaf-cfa5-4a06-ad07-cba386c52314",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "9b213051-a45f-4a9e-9566-77c3a85025d6",
                "title": "IBM QRadar: Get Offenses from QRadar",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "cfd45eaf-cfa5-4a06-ad07-cba386c52314"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Offenses from QRadar",
              "description": null,
              "arguments": {
                "name": "IBM QRadar",
                "config": "''",
                "params": {
                  "filter_string": "status=\"OPEN\""
                },
                "version": "1.6.2",
                "connector": "qradar",
                "operation": "get_offenses",
                "operationTitle": "Get Offenses from QRadar",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "f9c99172-a599-4f4f-9428-2b958e7119cf"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start-> Get Offenses from QRadar",
              "targetStep": "/api/3/workflow_steps/f9c99172-a599-4f4f-9428-2b958e7119cf",
              "sourceStep": "/api/3/workflow_steps/cfd45eaf-cfa5-4a06-ad07-cba386c52314",
              "label": null,
              "isExecuted": false,
              "uuid": "9ded33ae-77c4-467e-9a34-c6268025525d"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "755f8abf-a15c-418a-b3d5-4195fdd17477",
          "id": 4067,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "qradar"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Offense Types",
          "aliasName": null,
          "tag": "#IBM QRadar",
          "description": "Retrieves a list containing IDs of all the offense types from the QRadar server.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": null,
          "collection": "/api/3/workflow_collections/9a38c491-3e1d-4840-af6e-1407a79e15ad",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/74c76bb9-e3f8-4ca0-9212-f263a06d0041",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "bc9bba85-1766-4b8a-b812-ad836b30c82b",
                "title": "IBM QRadar: Get Offense Types",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "74c76bb9-e3f8-4ca0-9212-f263a06d0041"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Offense Types",
              "description": null,
              "arguments": {
                "name": "IBM QRadar",
                "config": "''",
                "params": [],
                "version": "1.6.2",
                "connector": "qradar",
                "operation": "get_offense_type",
                "operationTitle": "Get Offense Types",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "bcc14e4c-2be5-4189-acce-47557c949ca2"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start-> Get Offense Types",
              "targetStep": "/api/3/workflow_steps/bcc14e4c-2be5-4189-acce-47557c949ca2",
              "sourceStep": "/api/3/workflow_steps/74c76bb9-e3f8-4ca0-9212-f263a06d0041",
              "label": null,
              "isExecuted": false,
              "uuid": "7266e778-8b77-4c5f-baa6-2fe10d67f225"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "81fcbe98-f6de-4ee5-9212-c9cd805f011c",
          "id": 4070,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "qradar"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Manipulate Reference Set Content",
          "aliasName": null,
          "tag": "#IBM QRadar",
          "description": "Adds or deletes the content that you have specified from a specified reference set on QRadar.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": null,
          "collection": "/api/3/workflow_collections/9a38c491-3e1d-4840-af6e-1407a79e15ad",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/33378610-bd3d-4e6f-ac06-5f2591e7608f",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Manipulate Reference Set Content",
              "description": null,
              "arguments": {
                "name": "IBM QRadar",
                "config": "''",
                "params": {
                  "method": "Retrieves Value"
                },
                "version": "1.6.2",
                "connector": "qradar",
                "operation": "handle_reference_set_value",
                "operationTitle": "Manipulate Reference Set Content",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "0ecbd155-30b3-418f-831c-e0355d60663c"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "c385ad0e-847c-45bd-a634-cda1f415e28c",
                "title": "IBM QRadar: Manipulate Reference Set Content",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "33378610-bd3d-4e6f-ac06-5f2591e7608f"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start-> Manipulate Reference Set Content",
              "targetStep": "/api/3/workflow_steps/0ecbd155-30b3-418f-831c-e0355d60663c",
              "sourceStep": "/api/3/workflow_steps/33378610-bd3d-4e6f-ac06-5f2591e7608f",
              "label": null,
              "isExecuted": false,
              "uuid": "50391b52-25e7-46b5-b64d-74bb89c90c3e"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "83e93e5e-1921-4e00-b30d-041c77c5a045",
          "id": 4078,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "qradar"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "> IBM QRadar > Fetch",
          "aliasName": null,
          "tag": "#qradar #fetch #dataingestion",
          "description": "This playbook fetches the Offenses.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1676990399,
          "collection": "/api/3/workflow_collections/9a38c491-3e1d-4840-af6e-1407a79e15ad",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/26b987c5-7518-4050-acc3-f96380405d73",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Calculate QRadar Epoch Time",
              "description": null,
              "arguments": {
                "qradar_epoch": "{{ ( arrow.get(vars.curr_timestamp).shift(minutes=-vars.time_diff_min).int_timestamp) * 1000}}"
              },
              "status": null,
              "top": "760",
              "left": "680",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "14ba7403-990a-4934-856c-5a3462e316b1"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": []
                  },
                  "_configuration_schema": "[{\n\t\t\"title\": \"Search Query\",\n\t\t\"tooltip\": \"The Query to be run on QRadar to fetch offenses\",\n\t\t\"required\": true,\n\t\t\"editable\": true,\n\t\t\"visible\": true,\n\t\t\"type\": \"text\",\n\t\t\"name\": \"filter_string\",\n\t\t\"value\": \"status=\\\"OPEN\\\"\"\n\t}, {\n\t\t\"title\": \"Pull Offenses in the last X minutes\",\n\t\t\"tooltip\": \"Limit the search query specified above to filter the offenses created or modified in the last X minutes\",\n\t\t\"required\": true,\n\t\t\"editable\": true,\n\t\t\"visible\": true,\n\t\t\"type\": \"text\",\n\t\t\"name\": \"Pull_Sample_Offense_in_Past_X_Minutes\",\n\t\t\"value\": 10\n\n\t},\n\t{\n\t\t\"title\": \"Timezone of the QRadar server\",\n\t\t\"tooltip\": \"Required for the time conversion to pull events since the last X minutes for an offense\",\n\t\t\"required\": true,\n\t\t\"editable\": true,\n\t\t\"visible\": true,\n\t\t\"type\": \"text\",\n\t\t\"name\": \"qradar_timezone\",\n\t\t\"value\": \"UTC\"\n\n\t},\n\t{\n\t\t\"title\": \"Event Record Limit\",\n\t\t\"tooltip\": \"Pull number of events for an offense\",\n\t\t\"required\": true,\n\t\t\"editable\": true,\n\t\t\"visible\": true,\n\t\t\"type\": \"integer\",\n\t\t\"name\": \"event_record_limit\",\n\t\t\"value\": 50\n\t}\n]"
                }
              },
              "status": null,
              "top": "60",
              "left": "80",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "group": null,
              "uuid": "26b987c5-7518-4050-acc3-f96380405d73"
            },
            {
              "@type": "WorkflowStep",
              "name": "Collect IP ids",
              "description": null,
              "arguments": {
                "src_ips": "{{ vars.steps.Get_Offenses.data | json_query('[*].source_address_ids[]') }}",
                "destinations_ips": "{{ vars.steps.Get_Offenses.data | json_query('[*].local_destination_address_ids[]') }}"
              },
              "status": null,
              "top": "980",
              "left": "840",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "6dc195a7-92f3-411d-9579-dd7088b64d29"
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Result",
              "description": null,
              "arguments": {
                "data": "{{vars.all_offenses}}",
                "curr_timestamp": "{{vars.curr_timestamp}}",
                "QRadarLimitMacro": "{{vars.macro_list[2].get(\"macro_value\")}}",
                "QRadarPullTimeMacro": "{{vars.macro_list[0].get(\"macro_name\")}}",
                "QRadarTimeZoneMacro": "{{vars.macro_list[1].get(\"macro_value\")}}"
              },
              "status": null,
              "top": "1460",
              "left": "1040",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "8a34a1b3-d51f-4ce0-9cb1-65fd41a24a3c"
            },
            {
              "@type": "WorkflowStep",
              "name": "Update Offenses With IP Details",
              "description": null,
              "arguments": {
                "_dummy_for_src_addrs": "{% for each_offense in vars.all_offenses %}\n {% set offense_src_ips = [] %}\n {% for each_ip in vars.steps.Get_Source_Address_Details.data %}\n {% if each_ip.id in each_offense.source_address_ids %}\n {% set _temp =  offense_src_ips.append(each_ip) %}\n {% endif %}\n{% endfor %}\n{% set _temp2 = each_offense.update({\"source_address_details\": offense_src_ips}) %}\n {% endfor %}",
                "_dummy_for_dest_addrs": "{% for each_offense in vars.all_offenses %}\n {% set offense_dest_ips = [] %}\n {% for each_ip in vars.steps.Get_Destination_Address_Details.data %}\n {% if each_ip.id in each_offense.local_destination_address_ids %}\n {% set _temp =  offense_dest_ips.append(each_ip) %}\n{% endif %}\n{% endfor %}\n{% set _temp2 = each_offense.update({\"destination_address_details\": offense_dest_ips}) %}\n {% endfor %}"
              },
              "status": null,
              "top": "1320",
              "left": "1040",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "8d4973b1-a562-4108-b55e-3683fd078174"
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Time Configuration",
              "description": null,
              "arguments": {
                "curr_timestamp": "{{arrow.utcnow().int_timestamp}}",
                "last_pull_time": "{% if (vars.steps.Get_Macro_Value.data[\"hydra:member\"] | length) > 0 and vars.steps.Get_Macro_Value.data[\"hydra:member\"][0].value | int  > 0 %}{{vars.steps.Get_Macro_Value.data[\"hydra:member\"][0].value}}{% else %}{{ (arrow.utcnow().int_timestamp) - (vars.Pull_Sample_Offense_in_Past_X_Minutes| int)  *60 }}{% endif %}"
              },
              "status": null,
              "top": "520",
              "left": "480",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "9386adbd-ddfb-4127-9de2-7bb57dd6a1ad"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Destination Address Details",
              "description": null,
              "arguments": {
                "name": "IBM QRadar",
                "when": "{{(vars.all_offenses | length > 0) and (vars.destinations_ips | length > 0)}}",
                "config": "",
                "params": {
                  "destination_address_ids": "{{vars.destinations_ips}}"
                },
                "version": "1.6.2",
                "connector": "qradar",
                "operation": "get_destination_ip",
                "operationTitle": "Get Destination IP Addresses",
                "step_variables": []
              },
              "status": null,
              "top": "1200",
              "left": "1040",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "968f0cd3-ffe4-4801-9c3b-3c3c75ef92b8"
            },
            {
              "@type": "WorkflowStep",
              "name": "Configuration",
              "description": null,
              "arguments": {
                "macro_name": "{{vars['audit_info']['cyops_playbook_iri'].split('/')[-1].replace('-','_')}}",
                "filter_string": "status=\"OPEN\"",
                "qradar_timezone": "UTC",
                "event_record_limit": "50",
                "Pull_Sample_Offense_in_Past_X_Minutes": "10"
              },
              "status": null,
              "top": "180",
              "left": "80",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "9a4ba603-cd3f-4821-a459-2fd016035e7a"
            },
            {
              "@type": "WorkflowStep",
              "name": "Environment Setup",
              "description": null,
              "arguments": {
                "when": "{{vars.request.env_setup}}",
                "for_each": {
                  "item": "{{vars.macro_list}}",
                  "__bulk": false,
                  "parallel": true,
                  "condition": ""
                },
                "arguments": {
                  "QRadarMacroName": "{{vars.item.macro_name}}",
                  "QRadarMacroValue": "{{vars.item.macro_value}}",
                  "overrideIfNoMatch": "{{vars.item.override}}"
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/a7f82034-9e72-48b6-9d2a-3acd2043aceb"
              },
              "status": null,
              "top": "280",
              "left": "480",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "group": null,
              "uuid": "b3fe0300-1053-45a1-a4df-447351e9497a"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Macro Value",
              "description": null,
              "arguments": {
                "params": {
                  "iri": "/api/wf/api/dynamic-variable/?name={{vars.macro_list[0].get(\"macro_name\")}}",
                  "body": "",
                  "method": "GET"
                },
                "version": "3.2.1",
                "connector": "cyops_utilities",
                "operation": "make_cyops_request",
                "operationTitle": "FSR: Make FortiSOAR API Call",
                "step_variables": []
              },
              "status": null,
              "top": "400",
              "left": "480",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "group": null,
              "uuid": "bb772e1f-3e5e-4b3c-82c2-41024745089a"
            },
            {
              "@type": "WorkflowStep",
              "name": "Create Macro List",
              "description": null,
              "arguments": {
                "macro_list": "[{\"macro_name\": \"QRadarLastOffensePullTime_{{vars.macro_name}}\" , \"macro_value\": 0, \"override\": false},{\"macro_name\": \"QRadarTimeZone_{{vars.macro_name}}\" , \"macro_value\": \"{{vars.qradar_timezone}}\", \"override\": true},{\"macro_name\": \"QRadarEventLimit_{{vars.macro_name}}\" , \"macro_value\": \"{{vars.event_record_limit}}\", \"override\": true}]"
              },
              "status": null,
              "top": "280",
              "left": "80",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "bb9bbc77-b394-4b54-bd85-ce9c465051eb"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Offenses",
              "description": null,
              "arguments": {
                "name": "IBM QRadar",
                "config": "",
                "params": {
                  "filter_string": "{{vars.filter_string}} and (start_time > '{{vars.qradar_epoch}}' or last_updated_time > '{{vars.qradar_epoch}}' )"
                },
                "version": "1.6.2",
                "connector": "qradar",
                "operation": "get_offenses",
                "operationTitle": "Get Offenses from QRadar",
                "step_variables": {
                  "all_offenses": "{{ vars.result.data }}"
                }
              },
              "status": null,
              "top": "860",
              "left": "840",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "d9e84be8-d771-4ab5-b9a9-6180c3827d57"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Source Address Details",
              "description": null,
              "arguments": {
                "name": "IBM QRadar",
                "when": "{{(vars.all_offenses | length > 0) and (vars.src_ips | length > 0)}}",
                "config": "",
                "params": {
                  "source_address_ids": "{{vars.src_ips}}"
                },
                "version": "1.6.2",
                "connector": "qradar",
                "operation": "get_source_ip",
                "operationTitle": "Get Source IP Addresses",
                "step_variables": []
              },
              "status": null,
              "top": "1080",
              "left": "1040",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "e1f41be9-a63b-47d3-a0c4-cd0a39780fc4"
            },
            {
              "@type": "WorkflowStep",
              "name": "Calculate Diff in min",
              "description": null,
              "arguments": {
                "time_diff_min": "{{ (vars.curr_timestamp - vars.last_pull_time) / 60 | round }}"
              },
              "status": null,
              "top": "620",
              "left": "680",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "e7bd8d6b-fe5a-4c8e-b956-16f8b08354ae"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Create QRadar Last Offense Pull Time Macro -> Get Macro Value",
              "targetStep": "/api/3/workflow_steps/bb772e1f-3e5e-4b3c-82c2-41024745089a",
              "sourceStep": "/api/3/workflow_steps/b3fe0300-1053-45a1-a4df-447351e9497a",
              "label": null,
              "isExecuted": false,
              "uuid": "1641a35a-5566-41f7-b90d-8711ec64c490"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Calculate QRadar Epoch Time -> Get Offenses",
              "targetStep": "/api/3/workflow_steps/d9e84be8-d771-4ab5-b9a9-6180c3827d57",
              "sourceStep": "/api/3/workflow_steps/14ba7403-990a-4934-856c-5a3462e316b1",
              "label": null,
              "isExecuted": false,
              "uuid": "165871ad-e4a9-4e73-b45a-dec4ff0fa7b7"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Offenses -> Collect IP ids",
              "targetStep": "/api/3/workflow_steps/6dc195a7-92f3-411d-9579-dd7088b64d29",
              "sourceStep": "/api/3/workflow_steps/d9e84be8-d771-4ab5-b9a9-6180c3827d57",
              "label": null,
              "isExecuted": false,
              "uuid": "2996ef9d-adf4-4151-af90-9af429297131"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Destination Address Details -> Update Offenses With IP Details",
              "targetStep": "/api/3/workflow_steps/8d4973b1-a562-4108-b55e-3683fd078174",
              "sourceStep": "/api/3/workflow_steps/968f0cd3-ffe4-4801-9c3b-3c3c75ef92b8",
              "label": null,
              "isExecuted": false,
              "uuid": "359dfc5e-5b7a-4942-9f30-5c53c710cb55"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Update Offenses With IP Details -> Set Result",
              "targetStep": "/api/3/workflow_steps/8a34a1b3-d51f-4ce0-9cb1-65fd41a24a3c",
              "sourceStep": "/api/3/workflow_steps/8d4973b1-a562-4108-b55e-3683fd078174",
              "label": null,
              "isExecuted": false,
              "uuid": "76444248-4489-465d-8faa-e212aa79159a"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Source IP Details -> Get Destination Address Details",
              "targetStep": "/api/3/workflow_steps/968f0cd3-ffe4-4801-9c3b-3c3c75ef92b8",
              "sourceStep": "/api/3/workflow_steps/e1f41be9-a63b-47d3-a0c4-cd0a39780fc4",
              "label": null,
              "isExecuted": false,
              "uuid": "7c458095-4ab6-4db7-8e53-67c57179a0cb"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Collect IP ids -> Get Source IP Details",
              "targetStep": "/api/3/workflow_steps/e1f41be9-a63b-47d3-a0c4-cd0a39780fc4",
              "sourceStep": "/api/3/workflow_steps/6dc195a7-92f3-411d-9579-dd7088b64d29",
              "label": null,
              "isExecuted": false,
              "uuid": "7e1827bf-6581-43ea-8121-12b5ef5b81a7"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Copy of Configuration",
              "targetStep": "/api/3/workflow_steps/bb9bbc77-b394-4b54-bd85-ce9c465051eb",
              "sourceStep": "/api/3/workflow_steps/9a4ba603-cd3f-4821-a459-2fd016035e7a",
              "label": null,
              "isExecuted": false,
              "uuid": "86a16442-8846-4a96-81be-4294fdebe2fd"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Time Configuration -> Calculate Diff in min",
              "targetStep": "/api/3/workflow_steps/e7bd8d6b-fe5a-4c8e-b956-16f8b08354ae",
              "sourceStep": "/api/3/workflow_steps/9386adbd-ddfb-4127-9de2-7bb57dd6a1ad",
              "label": null,
              "isExecuted": false,
              "uuid": "95b958a3-0b67-45d8-a159-c88afc021f2c"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Macro Value -> Set Time Configuration",
              "targetStep": "/api/3/workflow_steps/9386adbd-ddfb-4127-9de2-7bb57dd6a1ad",
              "sourceStep": "/api/3/workflow_steps/bb772e1f-3e5e-4b3c-82c2-41024745089a",
              "label": null,
              "isExecuted": false,
              "uuid": "c15f5cdf-e8b5-4d7b-84b9-4566f66dabe6"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create Macro List -> Create QRadar Last Offense Pull Time Macro",
              "targetStep": "/api/3/workflow_steps/b3fe0300-1053-45a1-a4df-447351e9497a",
              "sourceStep": "/api/3/workflow_steps/bb9bbc77-b394-4b54-bd85-ce9c465051eb",
              "label": null,
              "isExecuted": false,
              "uuid": "dfd7c338-9cbd-40a1-9cc3-8457df2a4786"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Configuration",
              "targetStep": "/api/3/workflow_steps/9a4ba603-cd3f-4821-a459-2fd016035e7a",
              "sourceStep": "/api/3/workflow_steps/26b987c5-7518-4050-acc3-f96380405d73",
              "label": null,
              "isExecuted": false,
              "uuid": "e60c08c9-3e83-4403-898f-516e7bd24850"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Calculate Diff in min -> Calculate QRadar Epoch Time",
              "targetStep": "/api/3/workflow_steps/14ba7403-990a-4934-856c-5a3462e316b1",
              "sourceStep": "/api/3/workflow_steps/e7bd8d6b-fe5a-4c8e-b956-16f8b08354ae",
              "label": null,
              "isExecuted": false,
              "uuid": "e7ca8166-a085-4111-b6e8-ae2c7436a207"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "8f7eb129-98d4-43e8-a10b-8970e39065e9",
          "id": 4090,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "dataingestion",
            "fetch",
            "qradar"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Assets",
          "aliasName": null,
          "tag": "#IBM QRadar",
          "description": "Retrieves a detailed list of available assets from Qradar based on input parameters specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": null,
          "collection": "/api/3/workflow_collections/9a38c491-3e1d-4840-af6e-1407a79e15ad",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/ba21f195-8141-4697-a051-07df10e9bd77",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get Assets",
              "description": null,
              "arguments": {
                "name": "IBM QRadar",
                "config": "''",
                "params": {
                  "query.sort": "",
                  "max_results": 100,
                  "query.fields": "",
                  "filter_string": ""
                },
                "version": "1.6.2",
                "connector": "qradar",
                "operation": "get_assets",
                "operationTitle": "Get Assets",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "b55577fd-69da-4e87-8f38-d09be025baaa"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "3068f58b-411c-400f-b189-36bd2cf46fdc",
                "title": "IBM QRadar: Get Assets",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "ba21f195-8141-4697-a051-07df10e9bd77"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start-> Get Assets",
              "targetStep": "/api/3/workflow_steps/b55577fd-69da-4e87-8f38-d09be025baaa",
              "sourceStep": "/api/3/workflow_steps/ba21f195-8141-4697-a051-07df10e9bd77",
              "label": null,
              "isExecuted": false,
              "uuid": "6f328f2d-db8f-4e22-be13-ead325ff8af2"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "9d09ce74-b191-4857-9931-8ffec8d349d5",
          "id": 4080,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "qradar"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Delete Table Element",
          "aliasName": null,
          "tag": "#IBM QRadar",
          "description": "Specify the element to be deleted from a reference table on Qradar based on input parameters specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": null,
          "collection": "/api/3/workflow_collections/9a38c491-3e1d-4840-af6e-1407a79e15ad",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/40aa4b76-c2f2-488e-be06-e52ce8f439c7",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Delete Table Element",
              "description": null,
              "arguments": {
                "name": "IBM QRadar",
                "config": "''",
                "params": {
                  "path.name": "",
                  "query.value": "",
                  "query.fields": "",
                  "path.inner_key": "",
                  "path.outer_key": "",
                  "query.domain_id": "",
                  "query.namespace": ""
                },
                "version": "1.6.2",
                "connector": "qradar",
                "operation": "delete_table_element",
                "operationTitle": "Delete Table Element",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "347b3159-e3c5-45fe-8f84-d545cc97a6b3"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "777c7f58-fb33-46eb-80f8-7737128556d3",
                "title": "IBM QRadar: Delete Table Element",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "40aa4b76-c2f2-488e-be06-e52ce8f439c7"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start-> Delete Table Element",
              "targetStep": "/api/3/workflow_steps/347b3159-e3c5-45fe-8f84-d545cc97a6b3",
              "sourceStep": "/api/3/workflow_steps/40aa4b76-c2f2-488e-be06-e52ce8f439c7",
              "label": null,
              "isExecuted": false,
              "uuid": "18a7b793-2888-4aa9-8cb6-17acf42ed340"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "9dd3b45b-e18b-4195-a828-920b06a8ce52",
          "id": 4088,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "qradar"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Delete or Purge Reference Table",
          "aliasName": null,
          "tag": "#IBM QRadar",
          "description": "Delete a reference table or purge its content on Qradar based on the input parameters specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": null,
          "collection": "/api/3/workflow_collections/9a38c491-3e1d-4840-af6e-1407a79e15ad",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/7478e852-e534-4e73-93c2-f387383e3ee5",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Delete or Purge Reference Table",
              "description": null,
              "arguments": {
                "name": "IBM QRadar",
                "config": "''",
                "params": {
                  "path.name": "",
                  "query.fields": "",
                  "query.namespace": "",
                  "query.purge_only": "false"
                },
                "version": "1.6.2",
                "connector": "qradar",
                "operation": "delete_reference_table",
                "operationTitle": "Delete or Purge Reference Table",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "17ef8e9c-3878-484b-b5ff-94473bd1526e"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "ff6cb72d-5be3-4bf0-b63e-b0b9bc028086",
                "title": "IBM QRadar: Delete or Purge Reference Table",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "7478e852-e534-4e73-93c2-f387383e3ee5"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start-> Delete or Purge Reference Table",
              "targetStep": "/api/3/workflow_steps/17ef8e9c-3878-484b-b5ff-94473bd1526e",
              "sourceStep": "/api/3/workflow_steps/7478e852-e534-4e73-93c2-f387383e3ee5",
              "label": null,
              "isExecuted": false,
              "uuid": "8ddfa8e2-40c5-4d73-9c32-1ce692ed88a7"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "a663ff62-b58e-46a5-af91-0011ff6aec31",
          "id": 4085,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "qradar"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": ">> IBM QRadar > Init Macros",
          "aliasName": null,
          "tag": "#qradar #dataingestion",
          "description": "This playbook creates IBM QRadar macros if not exist.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [
            "QRadarMacroName",
            "QRadarMacroValue",
            "overrideIfNoMatch"
          ],
          "synchronous": false,
          "lastModifyDate": 1676990399,
          "collection": "/api/3/workflow_collections/9a38c491-3e1d-4840-af6e-1407a79e15ad",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/ab890ee1-d7fb-4f3c-875f-a81e23adc0b0",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get QRadar Macros",
              "description": null,
              "arguments": {
                "name": "Utilities",
                "params": {
                  "iri": "/api/wf/api/dynamic-variable/?format=json&name={{vars.QRadarMacroName}}",
                  "body": "",
                  "method": "GET"
                },
                "version": "2.5.0",
                "connector": "cyops_utilities",
                "operation": "make_cyops_request",
                "operationTitle": "CyOPs: Make CyOPs API Call",
                "step_variables": []
              },
              "status": null,
              "top": "120",
              "left": "171",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "0cc6a020-e7ca-48bf-a9cd-290bcf324fdc"
            },
            {
              "@type": "WorkflowStep",
              "name": "Create IBM QRadar Macro",
              "description": null,
              "arguments": {
                "params": {
                  "iri": "/api/wf/api/dynamic-variable/?format=json",
                  "body": "{ 'name': '{{vars.QRadarMacroName}}'   , 'value': '{{vars.QRadarMacroValue}}' }",
                  "method": "POST"
                },
                "version": "2.5.0",
                "connector": "cyops_utilities",
                "operation": "make_cyops_request",
                "operationTitle": "CyOPs: Make CyOPs API Call",
                "step_variables": []
              },
              "status": null,
              "top": "306",
              "left": "651",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "group": null,
              "uuid": "720cc5ee-1086-433a-ac3c-e7a2efb2ad66"
            },
            {
              "@type": "WorkflowStep",
              "name": "Fetch Macro Current Value",
              "description": null,
              "arguments": {
                "macroExistingRecord": "{{vars.steps.Get_QRadar_Macros.data['hydra:member'][0]}}"
              },
              "status": null,
              "top": "147",
              "left": "651",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "a11be765-fcd6-4623-8906-45022f44be36"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": {
                      "QRadarMacroName": "{{ vars.QRadarMacroName }}",
                      "QRadarMacroValue": "{{ vars.QRadarMacroValue }}",
                      "overrideIfNoMatch": "{{ vars.overrideIfNoMatch }}"
                    }
                  }
                }
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "group": null,
              "uuid": "ab890ee1-d7fb-4f3c-875f-a81e23adc0b0"
            },
            {
              "@type": "WorkflowStep",
              "name": "Update Macro If Required",
              "description": null,
              "arguments": {
                "when": "{{(vars.input.params.overrideIfNoMatch  == true) and (vars.macroExistingRecord.value != vars.QRadarMacroValue)}}",
                "params": {
                  "iri": "/api/wf/api/dynamic-variable/{{ vars.macroExistingRecord.id }}/",
                  "body": "{ 'name': '{{vars.QRadarMacroName}}'   , 'value': '{{vars.QRadarMacroValue}}' }",
                  "method": "PUT"
                },
                "version": "2.7.0",
                "connector": "cyops_utilities",
                "operation": "make_cyops_request",
                "operationTitle": "CyOPs: Make CyOPs API Call",
                "step_variables": []
              },
              "status": null,
              "top": "147",
              "left": "952",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "group": null,
              "uuid": "af23eded-2fca-4893-a55f-348c4fdccb38"
            },
            {
              "@type": "WorkflowStep",
              "name": "QRadar Macro Exists",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "Not Exist",
                    "step_iri": "/api/3/workflow_steps/720cc5ee-1086-433a-ac3c-e7a2efb2ad66",
                    "condition": "{{ vars.steps.Get_QRadar_Macros.data['hydra:totalItems'] == 0 }}"
                  },
                  {
                    "option": "Exist",
                    "default": true,
                    "step_iri": "/api/3/workflow_steps/a11be765-fcd6-4623-8906-45022f44be36"
                  }
                ]
              },
              "status": null,
              "top": "228",
              "left": "320",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "group": null,
              "uuid": "b4051f74-ca2a-49a1-af9f-e402bda1477d"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Get All Macros",
              "targetStep": "/api/3/workflow_steps/0cc6a020-e7ca-48bf-a9cd-290bcf324fdc",
              "sourceStep": "/api/3/workflow_steps/ab890ee1-d7fb-4f3c-875f-a81e23adc0b0",
              "label": null,
              "isExecuted": false,
              "uuid": "235a7c88-7c58-4aa3-b411-80b1beb543cd"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Fetch Macro Current Value -> Update Macro If Required",
              "targetStep": "/api/3/workflow_steps/af23eded-2fca-4893-a55f-348c4fdccb38",
              "sourceStep": "/api/3/workflow_steps/a11be765-fcd6-4623-8906-45022f44be36",
              "label": null,
              "isExecuted": false,
              "uuid": "3529a9e7-e89b-41de-b4b5-0de35f712b8d"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Check IBM QRadar Macro -> Create IBM QRadar Macro",
              "targetStep": "/api/3/workflow_steps/720cc5ee-1086-433a-ac3c-e7a2efb2ad66",
              "sourceStep": "/api/3/workflow_steps/b4051f74-ca2a-49a1-af9f-e402bda1477d",
              "label": "Not Exist",
              "isExecuted": false,
              "uuid": "706b41ae-34db-4753-a5e8-8b8f91f9b415"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get All Macros -> Check IBM QRadar Macro",
              "targetStep": "/api/3/workflow_steps/b4051f74-ca2a-49a1-af9f-e402bda1477d",
              "sourceStep": "/api/3/workflow_steps/0cc6a020-e7ca-48bf-a9cd-290bcf324fdc",
              "label": null,
              "isExecuted": false,
              "uuid": "93bf9e92-34cb-477c-be93-7771d380fa67"
            },
            {
              "@type": "WorkflowRoute",
              "name": "QRadar Macro Exists -> Fetch Macro Current Value",
              "targetStep": "/api/3/workflow_steps/a11be765-fcd6-4623-8906-45022f44be36",
              "sourceStep": "/api/3/workflow_steps/b4051f74-ca2a-49a1-af9f-e402bda1477d",
              "label": "Exist",
              "isExecuted": false,
              "uuid": "af5d49a8-a08b-4905-8313-092fbbc27874"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "a7f82034-9e72-48b6-9d2a-3acd2043aceb",
          "id": 4089,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "dataingestion",
            "qradar"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Destination IP Addresses",
          "aliasName": null,
          "tag": "#IBM QRadar",
          "description": "Retrieves IP address details associated with a destination address IDs from the QRadar server, based on the destination address IDs that you have specified",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": null,
          "collection": "/api/3/workflow_collections/9a38c491-3e1d-4840-af6e-1407a79e15ad",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/199382ed-afcd-4bb9-8865-fa8c28b44d85",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "4fb0870d-d2e8-413b-bcca-aeea3d16c24d",
                "title": "IBM QRadar: Get Destination IP Addresses",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "199382ed-afcd-4bb9-8865-fa8c28b44d85"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Destination IP Addresses",
              "description": null,
              "arguments": {
                "name": "IBM QRadar",
                "config": "''",
                "params": [],
                "version": "1.6.2",
                "connector": "qradar",
                "operation": "get_destination_ip",
                "operationTitle": "Get Destination IP Addresses",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "6181b12d-ab99-4d1f-acd0-03cc5d272da0"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start-> Get Destination IP Addresses",
              "targetStep": "/api/3/workflow_steps/6181b12d-ab99-4d1f-acd0-03cc5d272da0",
              "sourceStep": "/api/3/workflow_steps/199382ed-afcd-4bb9-8865-fa8c28b44d85",
              "label": null,
              "isExecuted": false,
              "uuid": "5b68fb1f-eccf-43c3-92e8-ab5099a912c7"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "ac6e4bd5-2273-4c79-8747-ae40c43ea26c",
          "id": 4076,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "qradar"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Assets Properties",
          "aliasName": null,
          "tag": "#IBM QRadar",
          "description": "Retrieves a detailed list of available asset properties from Qradar that can be used with assets update operation.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": null,
          "collection": "/api/3/workflow_collections/9a38c491-3e1d-4840-af6e-1407a79e15ad",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/272e7989-d471-4983-9304-8d0415cb70da",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get Assets Properties",
              "description": null,
              "arguments": {
                "name": "IBM QRadar",
                "config": "''",
                "params": {
                  "max_results": 100,
                  "query.fields": "",
                  "filter_string": ""
                },
                "version": "1.6.2",
                "connector": "qradar",
                "operation": "get_assets_properties",
                "operationTitle": "Get Assets Properties",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "1bed410d-c7b5-4b0e-9d73-140442621117"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "e34db2ff-edf9-47e1-a87f-4dae9c6d8d2b",
                "title": "IBM QRadar: Get Assets Properties",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "272e7989-d471-4983-9304-8d0415cb70da"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start-> Get Assets Properties",
              "targetStep": "/api/3/workflow_steps/1bed410d-c7b5-4b0e-9d73-140442621117",
              "sourceStep": "/api/3/workflow_steps/272e7989-d471-4983-9304-8d0415cb70da",
              "label": null,
              "isExecuted": false,
              "uuid": "c1f63be5-c98e-4192-a399-ad4dcd1a2968"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "bc0da614-61dc-45e8-9a8f-ee7d87a57b6b",
          "id": 4079,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "qradar"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Make an Ariel Query to QRadar",
          "aliasName": null,
          "tag": "#IBM QRadar",
          "description": "Executes an Ariel query on the QRadar server. QRadar uses the Ariel Query Language (AQL) to search for offenses or events based on query parameters.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": null,
          "collection": "/api/3/workflow_collections/9a38c491-3e1d-4840-af6e-1407a79e15ad",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/482458fa-9575-49fe-99a4-c530d38e26c9",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "3d2ff315-ed57-40b9-b0e3-98d3422d393d",
                "title": "IBM QRadar: Make an Ariel Query to QRadar",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "482458fa-9575-49fe-99a4-c530d38e26c9"
            },
            {
              "@type": "WorkflowStep",
              "name": "Make an Ariel Query to QRadar",
              "description": null,
              "arguments": {
                "name": "IBM QRadar",
                "config": "''",
                "params": {
                  "search_string": null
                },
                "version": "1.6.2",
                "connector": "qradar",
                "operation": "query_qradar",
                "operationTitle": "Make an Ariel Query to QRadar",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "d00ab3f3-362d-4088-b359-28d43e7fa7c5"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start-> Make an Ariel Query to QRadar",
              "targetStep": "/api/3/workflow_steps/d00ab3f3-362d-4088-b359-28d43e7fa7c5",
              "sourceStep": "/api/3/workflow_steps/482458fa-9575-49fe-99a4-c530d38e26c9",
              "label": null,
              "isExecuted": false,
              "uuid": "f82321ea-3b7d-4839-8150-1b1bdb9c0952"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "d0417fc9-2df2-4474-90e9-b5302aca5b21",
          "id": 4068,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "qradar"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "API - Push Offense From QRadar",
          "aliasName": null,
          "tag": "#qradar app",
          "description": "This playbook demonstrate the QRadar App. You need have QRadar CyberSponse App installed on QRadar.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1676990399,
          "collection": "/api/3/workflow_collections/9a38c491-3e1d-4840-af6e-1407a79e15ad",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/5cc52ab8-80ad-49b0-9dad-4987bd043068",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "qradar",
                "authentication_methods": [
                  ""
                ]
              },
              "status": null,
              "top": "53",
              "left": "234",
              "stepType": "/api/3/workflow_step_types/df26c7a2-4166-4ca5-91e5-548e24c01b5f",
              "group": null,
              "uuid": "5cc52ab8-80ad-49b0-9dad-4987bd043068"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Offense Details",
              "description": null,
              "arguments": {
                "name": "IBM QRadar",
                "config": "",
                "params": {
                  "filter_string": "id={{ vars.request.data.Offense_ID }}"
                },
                "version": "1.6.2",
                "connector": "qradar",
                "operation": "get_offenses",
                "operationTitle": "Get Offenses from QRadar",
                "step_variables": []
              },
              "status": null,
              "top": "160",
              "left": "400",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "7ac14252-3ffa-421a-8074-7d0808119a96"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Get Offense Details",
              "targetStep": "/api/3/workflow_steps/7ac14252-3ffa-421a-8074-7d0808119a96",
              "sourceStep": "/api/3/workflow_steps/5cc52ab8-80ad-49b0-9dad-4987bd043068",
              "label": null,
              "isExecuted": false,
              "uuid": "75e2ffa5-ea71-47c6-87df-1aa7e006d911"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "ebcdedf8-82d0-4072-a71c-badec8b2ccc8",
          "id": 4091,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "qradar app"
          ]
        }
      ]
    }
  ],
  "exported_tags": [
    "qradar",
    "dataingestion",
    "ingest",
    "create",
    "fetch",
    "qradar app"
  ]
}